{% extends "base.html" %}

{% block title %}Meeting Notes - VoiceNotes AI{% endblock %}

{% block content %}
<div class="result-section">
    <h2>
        <span>&#x2705;</span>
        <span>Your Meeting Notes</span>
    </h2>

    <div class="transcript">
        <h3>&#x1F4DD; Transcript</h3>
        <p>{{ transcript or "Transcript not available" }}</p>
    </div>

    <div class="notes">
        <h3>&#x2728; AI-Generated Summary</h3>
        <div>{{ summary or "Summary not available" }}</div>
    </div>

    <!-- Export Options -->
    <div class="export-options">
        <button class="btn btn-export export-btn" onclick="exportAsText()">
            <span>&#x1F4E5;</span>
            <span>Export as TXT</span>
        </button>
        <button class="btn btn-export export-btn" onclick="exportAsMarkdown()">
            <span>&#x1F4C4;</span>
            <span>Export as Markdown</span>
        </button>
        <button class="btn btn-secondary export-btn" onclick="copyToClipboard()">
            <span>&#x1F4CB;</span>
            <span>Copy to Clipboard</span>
        </button>
    </div>

    <!-- Action Buttons -->
    <div class="action-buttons">
        <a href="/" class="btn">
            <span>&#x2B06;</span>
            <span>Upload Another File</span>
        </a>
        <a href="/history" class="btn btn-secondary">
            <span>&#x1F4C2;</span>
            <span>View History</span>
        </a>
    </div>
</div>

{% endblock %}

{% block scripts %}
<script>
    // Export as TXT
    function exportAsText() {
        const transcript = document.querySelector('.transcript p').textContent;
        const summary = document.querySelector('.notes div').textContent;

        const content = `TRANSCRIPT:\n\n${transcript}\n\n\nSUMMARY:\n\n${summary}`;

        const blob = new Blob([content], { type: 'text/plain' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `meeting-notes-${Date.now()}.txt`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
    }

    // Export as Markdown
    function exportAsMarkdown() {
        const transcript = document.querySelector('.transcript p').textContent;
        const summary = document.querySelector('.notes div').textContent;

        const content = `# Meeting Notes\n\n## Transcript\n\n${transcript}\n\n## AI-Generated Summary\n\n${summary}`;

        const blob = new Blob([content], { type: 'text/markdown' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `meeting-notes-${Date.now()}.md`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
    }

    // Copy to Clipboard
    function copyToClipboard() {
        const transcript = document.querySelector('.transcript p').textContent;
        const summary = document.querySelector('.notes div').textContent;

        const content = `TRANSCRIPT:\n\n${transcript}\n\n\nSUMMARY:\n\n${summary}`;

        navigator.clipboard.writeText(content).then(() => {
            // Show success feedback
            const btn = event.target.closest('button');
            const originalText = btn.innerHTML;
            btn.innerHTML = '<span>&#x2705;</span><span>Copied!</span>';
            setTimeout(() => {
                btn.innerHTML = originalText;
            }, 2000);
        }).catch(err => {
            alert('Failed to copy to clipboard');
        });
    }
</script>
{% endblock %}
